# ccr-tauri é¡¹ç›® Justfile (Tauri æ¡Œé¢åº”ç”¨æž„å»ºè„šæœ¬) ðŸš€ðŸ–¥ï¸

# ä½¿ç”¨æŒ‡å— ðŸ“–
# - åœ¨ ccr-tauri ç›®å½•æ‰§è¡Œï¼š`just --list` æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡
# - å¿«é€Ÿå¼€å‘ï¼š`just dev` å¯åŠ¨ Tauri å¼€å‘æ¨¡å¼ (çƒ­é‡è½½)
# - æž„å»ºæ¡Œé¢åº”ç”¨ï¼š`just build` æˆ– `just release`
# - å‰ç«¯å¼€å‘ï¼š`just ui-dev` ä»…å¯åŠ¨å‰ç«¯æœåŠ¡å™¨
# - å®Œæ•´æ£€æŸ¥ï¼š`just ci` è¿è¡Œ CI æµç¨‹
# - å®‰è£…ä¾èµ–ï¼š`just setup` ä¸€é”®å®‰è£…æ‰€æœ‰ä¾èµ–
# - å‰ç½®è¦æ±‚ï¼šRust å·¥å…·é“¾ + Node.js 18+ ðŸ¦€ðŸ“¦

# äºŒè¿›åˆ¶åç§°
BIN := "ccr-tauri"
# å‰ç«¯ç›®å½•
UI_DIR := "src-ui"

# ä½¿ç”¨ bash ä½œä¸ºæ‰§è¡Œå…¥å£ ðŸ§­
set shell := ["bash", "-cu"]

# ANSI é¢œè‰²ä»£ç 
BOLD := "\\033[1m"
CYAN := "\\033[36m"
GREEN := "\\033[32m"
YELLOW := "\\033[33m"
BLUE := "\\033[34m"
MAGENTA := "\\033[35m"
RED := "\\033[31m"
RESET := "\\033[0m"

# é»˜è®¤ä»»åŠ¡ï¼šæ˜¾ç¤ºå¸®åŠ©èœå• â„¹ï¸
default: help

# æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨ä»»åŠ¡ ðŸ“œ
help:
  @echo -e "{{CYAN}}{{BOLD}}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—{{RESET}}"
  @echo -e "{{CYAN}}{{BOLD}}â•‘        CCR Tauri Justfile - å¯ç”¨å‘½ä»¤åˆ—è¡¨                 â•‘{{RESET}}"
  @echo -e "{{CYAN}}{{BOLD}}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{{RESET}}"
  @just --list

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸš€ å¿«é€Ÿå¼€å§‹å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# ä¸€é”®å®‰è£…æ‰€æœ‰ä¾èµ– ðŸ“¦
setup:
  @echo -e "{{MAGENTA}}{{BOLD}}â–¶ è®¾ç½®å¼€å‘çŽ¯å¢ƒ...{{RESET}}"
  @echo -e "{{MAGENTA}}  æ­¥éª¤ 1/3: æ£€æŸ¥ Tauri CLI{{RESET}}"
  @if ! command -v cargo-tauri &> /dev/null; then \
    echo -e "{{YELLOW}}  âš  Tauri CLI æœªå®‰è£…ï¼Œæ­£åœ¨å®‰è£…...{{RESET}}"; \
    cargo install tauri-cli --version "^2.0.0" --locked; \
    echo -e "{{GREEN}}  âœ“ Tauri CLI å®‰è£…å®Œæˆ{{RESET}}"; \
  else \
    echo -e "{{GREEN}}  âœ“ Tauri CLI å·²å®‰è£…: $$(cargo tauri --version){{RESET}}"; \
  fi
  @echo -e "{{MAGENTA}}  æ­¥éª¤ 2/3: æ£€æŸ¥ Rust ä¾èµ–{{RESET}}"
  cargo check
  @echo -e "{{MAGENTA}}  æ­¥éª¤ 3/3: å®‰è£…å‰ç«¯ä¾èµ–{{RESET}}"
  cd {{UI_DIR}} && npm install
  @echo -e "{{GREEN}}{{BOLD}}âœ“ çŽ¯å¢ƒè®¾ç½®å®Œæˆï¼çŽ°åœ¨å¯ä»¥è¿è¡Œ 'just dev' å¯åŠ¨å¼€å‘æ¨¡å¼{{RESET}}"

# å¼€å‘æ¨¡å¼ (Tauri Dev) - çƒ­é‡è½½æ”¯æŒ ðŸ”¥
dev:
  @echo -e "{{BLUE}}{{BOLD}}â–¶ å¯åŠ¨ Tauri å¼€å‘æ¨¡å¼...{{RESET}}"
  @echo -e "{{BLUE}}  ç‰¹æ€§: Rust åŽç«¯ + Vue å‰ç«¯çƒ­é‡è½½{{RESET}}"
  @echo -e "{{BLUE}}  å‰ç«¯åœ°å€: http://localhost:5173{{RESET}}"
  @if [ ! -d "{{UI_DIR}}/node_modules" ]; then \
    echo -e "{{YELLOW}}  âš  å‰ç«¯ä¾èµ–æœªå®‰è£…ï¼Œæ­£åœ¨å®‰è£…...{{RESET}}"; \
    cd {{UI_DIR}} && npm install; \
  fi
  cargo tauri dev

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸ—ï¸  æž„å»ºå‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# è°ƒè¯•æž„å»º (Debug æ¨¡å¼) ðŸ—ï¸
build:
  @echo -e "{{BLUE}}{{BOLD}}â–¶ å¼€å§‹è°ƒè¯•æž„å»º...{{RESET}}"
  @echo -e "{{BLUE}}  åŽç«¯: Rust Debug æ¨¡å¼{{RESET}}"
  @echo -e "{{BLUE}}  å‰ç«¯: Vue ç”Ÿäº§æž„å»º{{RESET}}"
  cargo build
  @echo -e "{{GREEN}}{{BOLD}}âœ“ è°ƒè¯•æž„å»ºå®Œæˆ{{RESET}} â†’ target/debug/{{BIN}}"

# å‘å¸ƒæž„å»º (Release ä¼˜åŒ–) - ç”Ÿæˆå®‰è£…åŒ… âš¡
release:
  @echo -e "{{MAGENTA}}{{BOLD}}â–¶ å¼€å§‹å‘å¸ƒæž„å»º...{{RESET}}"
  @echo -e "{{MAGENTA}}  æ¨¡å¼: Release ä¼˜åŒ– (LTO + ç¬¦å·å‰¥ç¦»){{RESET}}"
  @echo -e "{{MAGENTA}}  è¾“å‡º: è·¨å¹³å°å®‰è£…åŒ…{{RESET}}"
  cargo tauri build
  @echo -e "{{GREEN}}{{BOLD}}âœ“ å‘å¸ƒæž„å»ºå®Œæˆ{{RESET}}"
  @echo -e "{{GREEN}}  å®‰è£…åŒ…ä½ç½®: target/release/bundle/{{RESET}}"
  @ls -lh target/release/{{BIN}} 2>/dev/null | awk '{print "  äºŒè¿›åˆ¶å¤§å°: " $$5}' || true

# å¿«é€Ÿç±»åž‹æ£€æŸ¥ (ä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶) ðŸ©º
check:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ è¿è¡Œ Rust ç±»åž‹æ£€æŸ¥...{{RESET}}"
  cargo check
  @echo -e "{{GREEN}}{{BOLD}}âœ“ Rust ç±»åž‹æ£€æŸ¥é€šè¿‡{{RESET}}"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸŽ¨ å‰ç«¯å¼€å‘å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# å®‰è£…å‰ç«¯ä¾èµ– ðŸ“¦
ui-install:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ å®‰è£…å‰ç«¯ä¾èµ–...{{RESET}}"
  cd {{UI_DIR}} && npm install
  @echo -e "{{GREEN}}{{BOLD}}âœ“ å‰ç«¯ä¾èµ–å®‰è£…å®Œæˆ{{RESET}}"

# ä»…å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ (æ—  Tauri) ðŸŽ¨
ui-dev:
  @echo -e "{{BLUE}}{{BOLD}}â–¶ å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨...{{RESET}}"
  @echo -e "{{BLUE}}  åœ°å€: http://localhost:5173{{RESET}}"
  @echo -e "{{YELLOW}}  æ³¨æ„: è¿™åªæ˜¯å‰ç«¯é¢„è§ˆï¼ŒTauri Commands ä¸å¯ç”¨{{RESET}}"
  cd {{UI_DIR}} && npm run dev

# å‰ç«¯ç”Ÿäº§æž„å»º ðŸ“¦
ui-build:
  @echo -e "{{MAGENTA}}{{BOLD}}â–¶ æž„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬...{{RESET}}"
  cd {{UI_DIR}} && npm run build
  @echo -e "{{GREEN}}{{BOLD}}âœ“ å‰ç«¯æž„å»ºå®Œæˆ{{RESET}} â†’ {{UI_DIR}}/dist"

# å‰ç«¯ TypeScript ç±»åž‹æ£€æŸ¥ âœ…
ui-check:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ æ£€æŸ¥å‰ç«¯ TypeScript ç±»åž‹...{{RESET}}"
  cd {{UI_DIR}} && npx vue-tsc --noEmit
  @echo -e "{{GREEN}}{{BOLD}}âœ“ TypeScript ç±»åž‹æ£€æŸ¥é€šè¿‡{{RESET}}"

# å‰ç«¯é¢„è§ˆç”Ÿäº§æž„å»º ðŸ‘€
ui-preview:
  @echo -e "{{BLUE}}{{BOLD}}â–¶ é¢„è§ˆå‰ç«¯ç”Ÿäº§æž„å»º...{{RESET}}"
  @if [ ! -d "{{UI_DIR}}/dist" ]; then \
    echo -e "{{YELLOW}}  âš  æœªæ‰¾åˆ°æž„å»ºäº§ç‰©ï¼Œæ­£åœ¨æž„å»º...{{RESET}}"; \
    just ui-build; \
  fi
  cd {{UI_DIR}} && npm run preview

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… æµ‹è¯•å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# è¿è¡Œ Rust æµ‹è¯• âœ…
test:
  @echo -e "{{GREEN}}{{BOLD}}â–¶ è¿è¡Œ Rust æµ‹è¯•å¥—ä»¶...{{RESET}}"
  cargo test
  @echo -e "{{GREEN}}{{BOLD}}âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡{{RESET}}"

# è¿è¡Œæ‰€æœ‰æµ‹è¯• (åŒ…æ‹¬å¿½ç•¥çš„æµ‹è¯•) ðŸ§ª
test-all:
  @echo -e "{{GREEN}}{{BOLD}}â–¶ è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶...{{RESET}}"
  cargo test -- --include-ignored
  @echo -e "{{GREEN}}{{BOLD}}âœ“ å®Œæ•´æµ‹è¯•é€šè¿‡{{RESET}}"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ¨ ä»£ç è´¨é‡å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Rust ä»£ç æ ¼å¼åŒ– âœ¨
fmt:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ æ ¼å¼åŒ– Rust ä»£ç ...{{RESET}}"
  cargo fmt
  @echo -e "{{GREEN}}{{BOLD}}âœ“ Rust ä»£ç æ ¼å¼åŒ–å®Œæˆ{{RESET}}"

# æ£€æŸ¥ Rust ä»£ç æ ¼å¼ (ä¸ä¿®æ”¹æ–‡ä»¶) ðŸ”
fmt-check:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ æ£€æŸ¥ Rust ä»£ç æ ¼å¼...{{RESET}}"
  cargo fmt -- --check
  @echo -e "{{GREEN}}{{BOLD}}âœ“ Rust ä»£ç æ ¼å¼ç¬¦åˆè§„èŒƒ{{RESET}}"

# Rust é™æ€æ£€æŸ¥ (Clippy) â—
clippy:
  @echo -e "{{YELLOW}}{{BOLD}}â–¶ è¿è¡Œ Clippy é™æ€æ£€æŸ¥...{{RESET}}"
  @echo -e "{{YELLOW}}  æ¨¡å¼: æ‰€æœ‰è­¦å‘Šè§†ä¸ºé”™è¯¯{{RESET}}"
  cargo clippy --all-targets --all-features -- -D warnings
  @echo -e "{{GREEN}}{{BOLD}}âœ“ Clippy æ£€æŸ¥é€šè¿‡{{RESET}}"

# å®Œæ•´ä»£ç æ£€æŸ¥ (Rust + å‰ç«¯) ðŸ”§
lint: fmt clippy ui-check
  @echo -e "{{GREEN}}{{BOLD}}âœ“ ä»£ç è´¨é‡æ£€æŸ¥å…¨éƒ¨é€šè¿‡{{RESET}}"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸš€ å¼€å‘å·¥ä½œæµå‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# å¿«é€Ÿå¼€å‘å¾ªçŽ¯ (æ£€æŸ¥ â†’ æµ‹è¯•) âš¡
quick: check test
  @echo -e "{{GREEN}}{{BOLD}}âœ“ å¼€å‘éªŒè¯å®Œæˆ{{RESET}}"

# å®Œæ•´ CI æµç¨‹ (æ ¼å¼æ£€æŸ¥ + Clippy + æµ‹è¯• + å‰ç«¯æ£€æŸ¥) ðŸŽ¯
ci: fmt-check clippy test ui-check
  @echo -e "{{GREEN}}{{BOLD}}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—{{RESET}}"
  @echo -e "{{GREEN}}{{BOLD}}â•‘            âœ“ CI æµç¨‹å…¨éƒ¨é€šè¿‡                             â•‘{{RESET}}"
  @echo -e "{{GREEN}}{{BOLD}}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{{RESET}}"

# å‘å¸ƒå‰æ£€æŸ¥ (CI + æž„å»ºæµ‹è¯•) ðŸš¢
pre-release: ci
  @echo -e "{{MAGENTA}}{{BOLD}}â–¶ æ‰§è¡Œå‘å¸ƒå‰æ£€æŸ¥...{{RESET}}"
  @echo -e "{{MAGENTA}}  æ­¥éª¤: æµ‹è¯•å‘å¸ƒæž„å»º{{RESET}}"
  just release
  @echo -e "{{GREEN}}{{BOLD}}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—{{RESET}}"
  @echo -e "{{GREEN}}{{BOLD}}â•‘          âœ“ å‘å¸ƒå‰æ£€æŸ¥å…¨éƒ¨é€šè¿‡                           â•‘{{RESET}}"
  @echo -e "{{GREEN}}{{BOLD}}â•‘          å‡†å¤‡å‘å¸ƒåˆ°ç”Ÿäº§çŽ¯å¢ƒ                             â•‘{{RESET}}"
  @echo -e "{{GREEN}}{{BOLD}}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{{RESET}}"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸ“š æ–‡æ¡£å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æž„å»º Rust æ–‡æ¡£ (ä¸åŒ…å«ä¾èµ–) ðŸ“š
doc:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ ç”Ÿæˆ Rust æ–‡æ¡£...{{RESET}}"
  cargo doc --no-deps
  @echo -e "{{GREEN}}{{BOLD}}âœ“ æ–‡æ¡£ç”Ÿæˆå®Œæˆ{{RESET}}"

# æž„å»ºå¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ–‡æ¡£ ðŸŒ
doc-open:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ ç”Ÿæˆå¹¶æ‰“å¼€ Rust æ–‡æ¡£...{{RESET}}"
  cargo doc --no-deps --open

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸ§¹ æ¸…ç†ä¸Žç»´æŠ¤å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æ¸…ç† Rust æž„å»ºäº§ç‰© ðŸ§¹
clean:
  @echo -e "{{RED}}{{BOLD}}â–¶ æ¸…ç† Rust æž„å»ºäº§ç‰©...{{RESET}}"
  cargo clean
  @echo -e "{{GREEN}}{{BOLD}}âœ“ Rust æž„å»ºæ¸…ç†å®Œæˆ{{RESET}}"

# æ¸…ç†å‰ç«¯æž„å»ºäº§ç‰© ðŸ§¹
ui-clean:
  @echo -e "{{RED}}{{BOLD}}â–¶ æ¸…ç†å‰ç«¯æž„å»ºäº§ç‰©...{{RESET}}"
  rm -rf {{UI_DIR}}/dist
  rm -rf {{UI_DIR}}/node_modules
  rm -f {{UI_DIR}}/package-lock.json
  @echo -e "{{GREEN}}{{BOLD}}âœ“ å‰ç«¯æž„å»ºæ¸…ç†å®Œæˆ{{RESET}}"

# æ·±åº¦æ¸…ç† (Rust + å‰ç«¯) ðŸ’£
deep-clean: clean ui-clean
  @echo -e "{{RED}}{{BOLD}}â–¶ æ·±åº¦æ¸…ç†å®Œæˆ{{RESET}}"
  @echo -e "{{YELLOW}}  æç¤º: è¿è¡Œ 'just setup' é‡æ–°å®‰è£…ä¾èµ–{{RESET}}"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ðŸ”§ å®žç”¨å·¥å…·å‘½ä»¤
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ ðŸ·ï¸
version:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ ç‰ˆæœ¬ä¿¡æ¯{{RESET}}"
  @echo -e "{{CYAN}}  Cargo.toml:{{RESET}}"
  @grep '^version' Cargo.toml | head -1
  @echo -e "{{CYAN}}  package.json:{{RESET}}"
  @grep '"version"' {{UI_DIR}}/package.json | head -1
  @echo -e "{{CYAN}}  tauri.conf.json:{{RESET}}"
  @grep '"version"' tauri.conf.json | head -1

# æ£€æŸ¥çŽ¯å¢ƒä¾èµ– ðŸ”
check-env:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ æ£€æŸ¥å¼€å‘çŽ¯å¢ƒ...{{RESET}}"
  @echo -e "{{CYAN}}  Rust:{{RESET}}"
  @rustc --version
  @cargo --version
  @echo -e "{{CYAN}}  Node.js:{{RESET}}"
  @node --version
  @npm --version
  @echo -e "{{CYAN}}  Tauri CLI:{{RESET}}"
  @if command -v cargo-tauri &> /dev/null; then \
    cargo tauri --version; \
  else \
    echo -e "{{YELLOW}}  âš  æœªå®‰è£… - è¿è¡Œ 'just install-tauri-cli' å®‰è£…{{RESET}}"; \
  fi
  @echo -e "{{GREEN}}{{BOLD}}âœ“ çŽ¯å¢ƒæ£€æŸ¥å®Œæˆ{{RESET}}"

# å®‰è£… Tauri CLI ðŸ”§
install-tauri-cli:
  @echo -e "{{MAGENTA}}{{BOLD}}â–¶ å®‰è£… Tauri CLI...{{RESET}}"
  @echo -e "{{MAGENTA}}  ç‰ˆæœ¬: 2.x (æœ€æ–°ç¨³å®šç‰ˆ){{RESET}}"
  cargo install tauri-cli --version "^2.0.0" --locked
  @echo -e "{{GREEN}}{{BOLD}}âœ“ Tauri CLI å®‰è£…å®Œæˆ{{RESET}}"
  @cargo tauri --version

# æŸ¥çœ‹æž„å»ºäº§ç‰© ðŸ“¦
list-bundles:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ æž„å»ºäº§ç‰©åˆ—è¡¨{{RESET}}"
  @if [ -d "target/release/bundle" ]; then \
    find target/release/bundle -type f \( -name "*.dmg" -o -name "*.app" -o -name "*.AppImage" -o -name "*.deb" -o -name "*.msi" \) -exec ls -lh {} \; | awk '{print "  " $$9 " (" $$5 ")"}'; \
  else \
    echo -e "{{YELLOW}}  æœªæ‰¾åˆ°æž„å»ºäº§ç‰©ï¼Œè¯·å…ˆè¿è¡Œ 'just release'{{RESET}}"; \
  fi

# ç»Ÿè®¡ä»£ç è¡Œæ•° ðŸ“Š
loc:
  @echo -e "{{CYAN}}{{BOLD}}â–¶ ä»£ç ç»Ÿè®¡{{RESET}}"
  @echo -e "{{CYAN}}  Rust åŽç«¯:{{RESET}}"
  @find src -name "*.rs" | xargs wc -l | tail -1 | awk '{print "    " $$1 " è¡Œ"}'
  @echo -e "{{CYAN}}  Vue å‰ç«¯:{{RESET}}"
  @find {{UI_DIR}}/src -name "*.vue" -o -name "*.ts" | xargs wc -l 2>/dev/null | tail -1 | awk '{print "    " $$1 " è¡Œ"}' || echo "    0 è¡Œ"
  @echo -e "{{CYAN}}  æ€»è®¡:{{RESET}}"
  @(find src -name "*.rs"; find {{UI_DIR}}/src -name "*.vue" -o -name "*.ts" 2>/dev/null) | xargs wc -l 2>/dev/null | tail -1 | awk '{print "    " $$1 " è¡Œ"}' || echo "    ç»Ÿè®¡ä¸­..."
